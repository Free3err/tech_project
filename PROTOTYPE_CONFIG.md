# Конфигурация прототипа RelayBot

**Дата:** 09.02.2026  
**Версия:** Прототип v1.0

---

## Параметры прототипа

### Размеры робота
- **Длина:** 19 см
- **Ширина:** 16 см
- **Высота:** ~15-20 см (зависит от конструкции)

### Тестовая среда
- **Комната:** 2 x 1 метр (200 x 100 см)
- **Зоны:** 35 x 35 см каждая
- **Домашняя позиция:** (0.2, 0.5) м - 20см от левой стены, центр по ширине
- **Зона склада:** (1.65, 0.5) м - 20см от правой стены, центр по ширине
- **Расстояние между зонами:** ~1.45 метра

---

## Ключевые параметры конфигурации

### Одометрия (config.py)
```python
WHEEL_BASE = 0.14          # 14см между колесами
WHEEL_RADIUS = 0.03        # 3см радиус (6см диаметр колес)
ENCODER_TICKS_PER_REVOLUTION = 360
```

**Как измерить:**
- WHEEL_BASE: расстояние между центрами левого и правого колес
- WHEEL_RADIUS: измерьте диаметр колеса и разделите на 2

### Навигация
```python
POSITION_TOLERANCE = 0.05           # 5см допуск достижения цели
CUSTOMER_APPROACH_DISTANCE = 0.25   # 25см расстояние подхода
MAX_SPEED = 120                     # Снижена для безопасности
MIN_SPEED = 40                      # Плавное движение
```

### LiDAR
```python
PERSON_DETECTION_MIN_POINTS = 5           # Меньше точек для маленького пространства
PERSON_DETECTION_CLUSTER_DISTANCE = 0.15  # 15см кластеризация
PERSON_MIN_CLUSTER_SIZE = 0.15            # 15см минимум
PERSON_MAX_CLUSTER_SIZE = 0.5             # 50см максимум
OBSTACLE_MIN_DISTANCE = 0.15              # 15см минимальное расстояние
LIDAR_MAX_RANGE = 2.5                     # 2.5м максимум (размер комнаты)
```

### Планирование пути
```python
OBSTACLE_CLEARANCE = 0.10      # 10см зазор от препятствий
PLANNING_STEP_SIZE = 0.05      # 5см шаг планирования
MAP_RESOLUTION = 0.02          # 2см разрешение карты
```

### Карта (warehouse_map.yaml)
```yaml
width: 2.0          # 2 метра
height: 1.0         # 1 метр
resolution: 0.02    # 2см на пиксель

zones:
  home:
    x: 0.2          # 20см от левой стены
    y: 0.5          # Центр по ширине
    radius: 0.175   # Зона 35x35см
  
  warehouse:
    x: 1.65         # 20см от правой стены
    y: 0.5          # Центр по ширине
    radius: 0.175   # Зона 35x35см
```

---

## Калибровка прототипа

### 1. Измерение колес

```bash
# Измерьте ваши колеса
WHEEL_DIAMETER = ?  # см
WHEEL_BASE = ?      # см

# Обновите config.py
WHEEL_RADIUS = WHEEL_DIAMETER / 2 / 100  # в метрах
WHEEL_BASE = WHEEL_BASE / 100            # в метрах
```

### 2. Проверка направления моторов

```bash
python3 test_data.py
```

Робот должен двигаться вперед. Если нет - поменяйте провода моторов.

### 3. Настройка скорости

Начните с консервативных значений:
```python
MAX_SPEED = 80   # Начальное значение для тестов
MIN_SPEED = 30
```

Постепенно увеличивайте до комфортной скорости (не более 150).

### 4. Тестирование в маленькой комнате

1. Разместите робот в домашней позиции (0.2, 0.5)
2. Отметьте зону склада на расстоянии 1.45м
3. Запустите систему
4. Проверьте точность навигации

---

## Схема расположения

```
Вид сверху комнаты 2x1 метр:

0,0 ┌─────────────────────────────────────────┐ 2.0,0
    │                                         │
    │  [H]                            [W]     │
    │  Home                        Warehouse  │
    │  (0.2,0.5)                   (1.65,0.5) │
    │  35x35см                     35x35см    │
    │                                         │
0,1 └─────────────────────────────────────────┘ 2.0,1.0

Легенда:
[H] - Домашняя позиция (Home)
[W] - Зона склада (Warehouse)
←→  - 1.45 метра между зонами
```

---

## Рекомендации для прототипа

### Безопасность
- Начинайте с низкой скорости (MAX_SPEED = 80)
- Тестируйте в пустой комнате без препятствий
- Держите кнопку аварийной остановки под рукой
- Убедитесь что робот не может упасть (нет ступенек)

### Точность
- Используйте ровную поверхность (ламинат, линолеум)
- Избегайте ковров (проскальзывание колес)
- Калибруйте энкодеры на ровной поверхности
- Проверяйте что LiDAR не перекрыт конструкцией

### Тестирование
1. **Тест одометрии:** Робот движется 1 метр прямо
2. **Тест поворота:** Робот поворачивается на 90°
3. **Тест навигации:** Робот едет из home в warehouse
4. **Тест обнаружения:** Робот обнаруживает человека на расстоянии 50см
5. **Тест полного цикла:** Полный цикл доставки

---

## Отличия от полноразмерной версии

| Параметр | Полноразмерный | Прототип | Изменение |
|----------|----------------|----------|-----------|
| Комната | 10x10 м | 2x1 м | -80% |
| Зоны | 1x1 м | 0.35x0.35 м | -65% |
| Робот | 25x30 см | 16x19 см | -36% |
| MAX_SPEED | 150 | 120 | -20% |
| POSITION_TOLERANCE | 10 см | 5 см | -50% |
| OBSTACLE_CLEARANCE | 30 см | 10 см | -67% |
| MAP_RESOLUTION | 5 см | 2 см | +60% точности |
| NUM_PARTICLES | 200 | 150 | -25% |

---

## Следующие шаги

1. **Измерьте параметры вашего робота**
   - Расстояние между колесами
   - Радиус колес
   - Проверьте тики энкодера

2. **Обновите config.py**
   - WHEEL_BASE
   - WHEEL_RADIUS
   - Порты (ARDUINO_PORT, LIDAR_PORT)

3. **Создайте физическую среду**
   - Отметьте комнату 2x1 метр
   - Отметьте домашнюю позицию
   - Отметьте зону склада

4. **Запустите тесты**
   ```bash
   python3 test_data.py
   python3 test_performance.py
   python3 -m pytest tests/unit/ -v
   ```

5. **Начните с простых тестов**
   - Движение вперед/назад
   - Повороты
   - Навигация между зонами
   - Обнаружение препятствий

---

**Версия документа:** 1.0  
**Последнее обновление:** 09.02.2026
